<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Prediksi Harga Rumah</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>

  <body
    class="bg-gradient-to-br from-slate-100 to-slate-200 min-h-screen flex items-center justify-center px-4"
  >
    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-xl p-8">
      <!-- Header -->
      <div class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-slate-800">Prediksi Harga Rumah</h1>
        <p class="text-slate-500 mt-2">
          Masukkan spesifikasi rumah untuk mendapatkan estimasi harga
        </p>
      </div>

      <!-- Form -->
      <form id="predictForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Left Column -->
        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Jumlah Kamar Tidur</label
          >
          <input
            type="number"
            name="bedrooms"
            required
            class="input"
            placeholder="Contoh: 3"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Jumlah Kamar Mandi</label
          >
          <input
            type="number"
            step="0.5"
            name="bathrooms"
            required
            class="input"
            placeholder="Contoh: 2"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Luas Bangunan (sqft)</label
          >
          <input
            type="number"
            name="sqft_living"
            required
            class="input"
            placeholder="Contoh: 1800"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Luas Tanah (sqft)</label
          >
          <input
            type="number"
            name="sqft_lot"
            required
            class="input"
            placeholder="Contoh: 4000"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Jumlah Lantai</label
          >
          <input
            type="number"
            step="0.5"
            name="floors"
            required
            class="input"
            placeholder="Contoh: 1"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Waterfront</label
          >
          <select name="waterfront" class="input">
            <option value="0">Tidak</option>
            <option value="1">Ya</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Kondisi Rumah (1–5)</label
          >
          <input
            type="number"
            min="1"
            max="5"
            name="condition"
            required
            class="input"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Grade Bangunan (1–13)</label
          >
          <input
            type="number"
            min="1"
            max="13"
            name="grade"
            required
            class="input"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Luas Bangunan Atas (sqft)</label
          >
          <input type="number" name="sqft_above" required class="input" />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Luas Basement (sqft)</label
          >
          <input type="number" name="sqft_basement" value="0" class="input" />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Tahun Dibangun</label
          >
          <input
            type="number"
            name="yr_built"
            required
            class="input"
            placeholder="Contoh: 1990"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-600"
            >Tahun Renovasi</label
          >
          <input type="number" name="yr_renovated" value="0" class="input" />
        </div>

        <!-- Submit -->
        <div class="md:col-span-2 mt-4">
          <button
            type="submit"
            class="w-full py-3 rounded-xl bg-slate-800 text-white font-semibold hover:bg-slate-700 transition"
          >
            Prediksi Harga Rumah
          </button>
        </div>
      </form>

      <!-- Result -->
      <div
        id="result"
        class="hidden mt-8 p-6 rounded-xl bg-slate-100 text-center"
      >
        <p class="text-slate-600">Estimasi Harga Rumah</p>
        <h2 id="price" class="text-3xl font-bold text-slate-800 mt-2"></h2>
      </div>
    </div>

    <!-- Tailwind input style -->
    <style>
      .input {
        @apply mt-1 w-full rounded-lg border border-slate-300 px-4 py-2 text-slate-700 focus:outline-none focus:ring-2 focus:ring-slate-400;
      }
    </style>

    <!-- Script -->
    <script>
      const form = document.getElementById("predictForm");
      const resultBox = document.getElementById("result");
      const priceEl = document.getElementById("price");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const data = Object.fromEntries(new FormData(form).entries());
        for (const key in data) data[key] = Number(data[key]);

        const response = await fetch("http://127.0.0.1:8000/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });

        const res = await response.json();
        priceEl.innerHTML = `
        Rp ${res.price_idr.toLocaleString("id-ID")}
        <div class="text-sm text-slate-500 mt-1">
            ≈ $${res.price_usd.toLocaleString("en-US")}
        </div>
        `;
        resultBox.classList.remove("hidden");
      });
    </script>
  </body>
</html>
